<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tournament.io | Live Purple & Black Tournament Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        :root {
            --primary-dark: #0a0a14;
            --secondary-dark: #12121f;
            --primary-purple: #8a2be2;
            --accent-purple: #9d4edd;
            --glow-purple: #bf40bf;
            --light-text: #f0e6ff;
            --dark-text: #1a1a2e;
            --success: #00c853;
            --warning: #ff9800;
            --danger: #f44336;
            --card-bg: rgba(26, 26, 46, 0.8);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--primary-dark);
            color: var(--light-text);
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(138, 43, 226, 0.15) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(138, 43, 226, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 50% 50%, rgba(26, 26, 46, 0.8) 0%, transparent 100%);
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 2px solid var(--primary-purple);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
            margin-bottom: 30px;
            background-color: rgba(10, 10, 20, 0.9);
            border-radius: 10px;
            padding: 15px 25px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            text-shadow: 0 0 10px var(--primary-purple), 0 0 20px var(--primary-purple);
        }
        
        .logo i {
            color: var(--primary-purple);
            filter: drop-shadow(0 0 5px var(--glow-purple));
        }
        
        nav {
            display: flex;
            gap: 20px;
        }
        
        .nav-btn {
            background: none;
            border: none;
            color: var(--light-text);
            font-size: 1rem;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav-btn:hover {
            background-color: rgba(138, 43, 226, 0.2);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
            transform: translateY(-2px);
        }
        
        .nav-btn.active {
            background-color: var(--primary-purple);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.7);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .credits {
            background-color: var(--secondary-dark);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            border: 1px solid var(--primary-purple);
            box-shadow: 0 0 8px rgba(138, 43, 226, 0.5);
        }
        
        .credits i {
            color: gold;
            margin-right: 5px;
        }
        
        .profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid var(--accent-purple);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.7);
        }
        
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .content-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: white;
            text-shadow: 0 0 10px rgba(138, 43, 226, 0.7);
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(138, 43, 226, 0.5);
        }
        
        /* Login Panels */
        .login-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .login-box {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            width: 100%;
            max-width: 450px;
            border: 1px solid var(--primary-purple);
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.4);
            transition: transform 0.3s ease;
        }
        
        .login-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 30px rgba(138, 43, 226, 0.6);
        }
        
        .login-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--accent-purple);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .login-title i {
            font-size: 1.8rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            background-color: rgba(10, 10, 20, 0.8);
            border: 1px solid rgba(138, 43, 226, 0.5);
            border-radius: 8px;
            color: var(--light-text);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }
        
        .btn {
            padding: 12px 25px;
            background-color: var(--primary-purple);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            background-color: var(--accent-purple);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.7);
            transform: translateY(-2px);
        }
        
        .btn-small {
            padding: 8px 15px;
            font-size: 0.9rem;
            border-radius: 6px;
            width: auto;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary-purple);
            color: var(--light-text);
        }
        
        .btn-outline:hover {
            background-color: rgba(138, 43, 226, 0.2);
        }
        
        /* Tournaments Section */
        .tournaments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .tournament-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--primary-purple);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .tournament-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 25px rgba(138, 43, 226, 0.6);
        }
        
        .tournament-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-purple), var(--accent-purple));
        }
        
        .tournament-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: white;
        }
        
        .tournament-game {
            display: inline-block;
            background-color: rgba(138, 43, 226, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .tournament-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #aaa;
        }
        
        .tournament-prize {
            color: gold;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .tournament-cost {
            color: var(--accent-purple);
            font-weight: 600;
        }
        
        .tournament-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        /* Profile Section */
        .profile-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 20px;
        }
        
        .profile-sidebar {
            flex: 1;
            min-width: 250px;
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--primary-purple);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
        }
        
        .profile-main {
            flex: 2;
            min-width: 300px;
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--primary-purple);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
        }
        
        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-purple), var(--accent-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: bold;
            border: 4px solid white;
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.7);
        }
        
        .profile-info h3 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .profile-info p {
            color: #aaa;
            margin-bottom: 10px;
        }
        
        .profile-stats {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat {
            text-align: center;
            padding: 15px;
            background-color: rgba(10, 10, 20, 0.6);
            border-radius: 10px;
            flex: 1;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-purple);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #aaa;
            margin-top: 5px;
        }
        
        /* Admin Section */
        .admin-actions {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .admin-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--primary-purple);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .admin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 25px rgba(138, 43, 226, 0.6);
        }
        
        .admin-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary-purple);
        }
        
        .admin-card h3 {
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        /* Customization options */
        .customization-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .color-option {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .color-option:hover, .color-option.selected {
            border-color: white;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }
        
        .avatar-option {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .avatar-option:hover, .avatar-option.selected {
            border-color: var(--primary-purple);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.7);
        }
        
        /* Firebase Status */
        .firebase-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--secondary-dark);
            padding: 10px 15px;
            border-radius: 10px;
            border: 1px solid var(--primary-purple);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
        }
        
        .firebase-status.connected {
            border-color: var(--success);
            box-shadow: 0 0 10px rgba(0, 200, 83, 0.5);
        }
        
        .firebase-status.disconnected {
            border-color: var(--danger);
            box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .status-dot.connected {
            background-color: var(--success);
            box-shadow: 0 0 10px var(--success);
        }
        
        .status-dot.disconnected {
            background-color: var(--danger);
            box-shadow: 0 0 10px var(--danger);
        }
        
        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1001;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            border: 2px solid var(--primary-purple);
            box-shadow: 0 0 30px rgba(138, 43, 226, 0.7);
            position: relative;
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: var(--light-text);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--accent-purple);
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: none;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }
        
        .loading-spinner.active {
            display: flex;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(138, 43, 226, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-purple);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Footer */
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            border-top: 1px solid rgba(138, 43, 226, 0.3);
            color: #aaa;
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            nav {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .profile-container {
                flex-direction: column;
            }
            
            .firebase-status {
                bottom: 10px;
                right: 10px;
                left: 10px;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Firebase Status Indicator -->
    <div class="firebase-status disconnected" id="firebaseStatus">
        <span class="status-dot disconnected"></span>
        <span>Firebase: Disconnected</span>
    </div>
    
    <!-- Create Tournament Modal -->
    <div class="modal" id="createTournamentModal">
        <div class="modal-content">
            <button class="modal-close" id="closeTournamentModal">&times;</button>
            <h3 class="modal-title">Create New Tournament</h3>
            <div class="form-group">
                <label for="tournamentName">Tournament Name</label>
                <input type="text" id="tournamentName" class="form-control" placeholder="e.g., COD Championship">
            </div>
            <div class="form-group">
                <label for="tournamentGame">Game</label>
                <select id="tournamentGame" class="form-control">
                    <option>Call of Duty: Warzone</option>
                    <option>Call of Duty: Modern Warfare</option>
                    <option>Call of Duty: Vanguard</option>
                    <option>Call of Duty: Mobile</option>
                    <option>Other</option>
                </select>
            </div>
            <div class="form-group">
                <label for="tournamentDate">Date</label>
                <input type="date" id="tournamentDate" class="form-control">
            </div>
            <div class="form-group">
                <label for="tournamentPrize">Prize Pool ($)</label>
                <input type="number" id="tournamentPrize" class="form-control" placeholder="e.g., 5000" min="0">
            </div>
            <div class="form-group">
                <label for="tournamentCost">Entry Cost (Credits)</label>
                <input type="number" id="tournamentCost" class="form-control" placeholder="e.g., 200" min="0">
            </div>
            <div class="form-group">
                <label for="tournamentMax">Max Participants</label>
                <input type="number" id="tournamentMax" class="form-control" placeholder="e.g., 64" min="2" max="256">
            </div>
            <button class="btn" id="createTournamentSubmit">Create Tournament</button>
        </div>
    </div>
    
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
    </div>
    
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-trophy"></i>
                <span>Tournament.io</span>
            </div>
            
            <nav>
                <button class="nav-btn active" data-section="home">Home</button>
                <button class="nav-btn" data-section="tournaments">Tournaments</button>
                <button class="nav-btn" data-section="profile">My Profile</button>
                <button class="nav-btn" data-section="admin">Admin Panel</button>
            </nav>
            
            <div class="user-info">
                <div class="credits">
                    <i class="fas fa-coins"></i>
                    <span id="credit-balance">0</span>
                </div>
                <div class="profile-pic" id="profile-icon">?</div>
                <button class="btn btn-small" id="logoutBtn" style="display: none;">Logout</button>
            </div>
        </header>
        
        <main>
            <!-- Home/Landing Section -->
            <section id="home" class="content-section active">
                <h2 class="section-title">Welcome to Tournament.io</h2>
                <p style="margin-bottom: 25px; font-size: 1.1rem;">Host and join competitive gaming tournaments with our credit-based system. Customize your profile, compete for prizes, and climb the leaderboards!</p>
                
                <div class="login-container">
                    <div class="login-box" id="loginBox">
                        <h3 class="login-title"><i class="fas fa-user"></i> Login / Register</h3>
                        <div class="form-group">
                            <label for="loginEmail">Email</label>
                            <input type="email" id="loginEmail" class="form-control" placeholder="Enter your email">
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Password</label>
                            <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password">
                        </div>
                        <div class="form-group" style="display: flex; gap: 10px;">
                            <button class="btn" id="loginBtn">Login</button>
                            <button class="btn btn-outline" id="registerBtn">Register</button>
                        </div>
                        <div class="form-group" style="margin-top: 20px; display: none;" id="adminLoginSection">
                            <label for="adminCode">Admin Code (Optional)</label>
                            <input type="password" id="adminCode" class="form-control" placeholder="Enter admin code if you have one">
                        </div>
                        <p style="margin-top: 15px; font-size: 0.9rem; color: #aaa;">Demo: Use any email/password to register</p>
                    </div>
                    
                    <div class="login-box" id="welcomeBox" style="display: none;">
                        <h3 class="login-title"><i class="fas fa-user-check"></i> Welcome Back!</h3>
                        <div style="text-align: center; padding: 20px 0;">
                            <div class="profile-avatar" style="width: 80px; height: 80px; margin: 0 auto 20px;" id="welcomeAvatar">?</div>
                            <h3 id="welcomeName">User</h3>
                            <p id="welcomeRole" style="color: var(--accent-purple); margin-bottom: 20px;">Player</p>
                            <div style="display: flex; justify-content: center; gap: 15px;">
                                <button class="btn btn-small" id="goToTournamentsBtn">Browse Tournaments</button>
                                <button class="btn btn-small btn-outline" id="goToProfileBtn">My Profile</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 40px; background-color: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px solid rgba(138, 43, 226, 0.5);">
                    <h3 style="margin-bottom: 15px; color: var(--accent-purple);">How It Works</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
                        <div>
                            <h4 style="color: white; margin-bottom: 10px;"><i class="fas fa-user-circle" style="color: var(--primary-purple); margin-right: 10px;"></i> Create Profile</h4>
                            <p style="color: #ccc;">Customize your player profile with avatar, colors, and bio.</p>
                        </div>
                        <div>
                            <h4 style="color: white; margin-bottom: 10px;"><i class="fas fa-coins" style="color: gold; margin-right: 10px;"></i> Earn Credits</h4>
                            <p style="color: #ccc;">Win tournaments or purchase credits to enter competitions.</p>
                        </div>
                        <div>
                            <h4 style="color: white; margin-bottom: 10px;"><i class="fas fa-trophy" style="color: var(--accent-purple); margin-right: 10px;"></i> Join Tournaments</h4>
                            <p style="color: #ccc;">Use credits to enter tournaments and compete for prizes.</p>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 40px; background-color: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px solid rgba(138, 43, 226, 0.5);">
                    <h3 style="margin-bottom: 15px; color: var(--accent-purple);">Live Stats</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; color: var(--primary-purple); font-weight: bold;" id="liveUsersCount">0</div>
                            <div style="color: #aaa;">Active Users</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; color: gold; font-weight: bold;" id="liveTournamentsCount">0</div>
                            <div style="color: #aaa;">Active Tournaments</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; color: var(--accent-purple); font-weight: bold;" id="liveMatchesCount">0</div>
                            <div style="color: #aaa;">Matches Today</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; color: var(--success); font-weight: bold;" id="livePrizePool">$0</div>
                            <div style="color: #aaa;">Total Prize Pool</div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Tournaments Section -->
            <section id="tournaments" class="content-section">
                <h2 class="section-title">Live Tournaments</h2>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                    <p>Use your credits to enter tournaments and win prizes!</p>
                    <button class="btn btn-small" id="createTournamentBtn" style="display: none;"><i class="fas fa-plus"></i> Create Tournament</button>
                </div>
                
                <div class="tournaments-grid" id="tournamentsContainer">
                    <!-- Tournament cards will be loaded from Firebase -->
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-outline" id="loadMoreTournaments" style="display: none;">Load More Tournaments</button>
                </div>
            </section>
            
            <!-- Profile Section -->
            <section id="profile" class="content-section">
                <h2 class="section-title">My Profile</h2>
                <div class="profile-container">
                    <div class="profile-sidebar">
                        <div class="profile-header">
                            <div class="profile-avatar" id="profile-avatar">?</div>
                            <div class="profile-info">
                                <h3 id="profile-name">Not Logged In</h3>
                                <p id="profile-title">Player</p>
                                <p id="profile-join-date">Member since: --</p>
                            </div>
                        </div>
                        
                        <div class="profile-stats">
                            <div class="stat">
                                <div class="stat-value" id="stat-wins">0</div>
                                <div class="stat-label">Tournament Wins</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="stat-joined">0</div>
                                <div class="stat-label">Tournaments Joined</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 25px;">
                            <h4 style="margin-bottom: 15px; color: var(--accent-purple);">Bio</h4>
                            <p id="profile-bio">Login to customize your profile!</p>
                        </div>
                    </div>
                    
                    <div class="profile-main">
                        <h3 style="margin-bottom: 20px; color: var(--accent-purple);">Customize Profile</h3>
                        
                        <div style="margin-bottom: 30px;">
                            <h4 style="margin-bottom: 15px;">Avatar</h4>
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                <div class="avatar-option selected" data-avatar="A" style="background: linear-gradient(45deg, var(--primary-purple), var(--accent-purple));">A</div>
                                <div class="avatar-option" data-avatar="B" style="background: linear-gradient(45deg, #3498db, #2ecc71);">B</div>
                                <div class="avatar-option" data-avatar="C" style="background: linear-gradient(45deg, #e74c3c, #f39c12);">C</div>
                                <div class="avatar-option" data-avatar="D" style="background: linear-gradient(45deg, #9b59b6, #34495e);">D</div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 30px;">
                            <h4 style="margin-bottom: 15px;">Player Title</h4>
                            <select id="playerTitle" class="form-control">
                                <option>Rookie</option>
                                <option>Player</option>
                                <option>Pro Player</option>
                                <option>Veteran</option>
                                <option>Champion</option>
                                <option>Legend</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 30px;">
                            <h4 style="margin-bottom: 15px;">Bio</h4>
                            <textarea id="playerBio" class="form-control" rows="4" placeholder="Tell others about yourself..." disabled></textarea>
                        </div>
                        
                        <button class="btn" id="saveProfileBtn" disabled>Save Profile Changes</button>
                    </div>
                </div>
            </section>
            
            <!-- Admin Section -->
            <section id="admin" class="content-section">
                <h2 class="section-title">Admin Panel</h2>
                <p style="margin-bottom: 25px;" id="adminMessage">This area is accessible only to administrators.</p>
                
                <div class="admin-actions" id="adminActions" style="display: none;">
                    <div class="admin-card">
                        <i class="fas fa-trophy"></i>
                        <h3>Manage Tournaments</h3>
                        <p>Create, edit, or remove tournaments</p>
                        <button class="btn btn-small" id="manageTournamentsBtn" style="margin-top: 15px;">Manage</button>
                    </div>
                    
                    <div class="admin-card">
                        <i class="fas fa-users"></i>
                        <h3>User Management</h3>
                        <p>View and manage user accounts</p>
                        <button class="btn btn-small" id="manageUsersBtn" style="margin-top: 15px;">Manage Users</button>
                    </div>
                    
                    <div class="admin-card">
                        <i class="fas fa-coins"></i>
                        <h3>Credit System</h3>
                        <p>Adjust credit balances and pricing</p>
                        <button class="btn btn-small" id="manageCreditsBtn" style="margin-top: 15px;">Manage Credits</button>
                    </div>
                    
                    <div class="admin-card">
                        <i class="fas fa-cog"></i>
                        <h3>Platform Settings</h3>
                        <p>Configure global platform settings</p>
                        <button class="btn btn-small" id="platformSettingsBtn" style="margin-top: 15px;">Settings</button>
                    </div>
                </div>
                
                <div style="margin-top: 40px; background-color: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px solid rgba(138, 43, 226, 0.5);" id="adminStats" style="display: none;">
                    <h3 style="margin-bottom: 20px; color: var(--accent-purple);">Platform Statistics</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--primary-purple); font-weight: bold;" id="totalUsers">0</div>
                            <div style="color: #aaa;">Total Users</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: gold; font-weight: bold;" id="totalTournaments">0</div>
                            <div style="color: #aaa;">Total Tournaments</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--accent-purple); font-weight: bold;" id="totalCredits">0</div>
                            <div style="color: #aaa;">Total Credits</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--success); font-weight: bold;" id="totalPrize">$0</div>
                            <div style="color: #aaa;">Total Prize Money</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <footer>
            <p>Tournament.io &copy; 2023 | Live Tournament Platform with Firebase & GitHub Pages</p>
            <p style="margin-top: 10px;">This is a live tournament platform. Data is stored in Firebase and updates in real-time.</p>
        </footer>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB3V3cZ8cQZ8Q2Q2Q2Q2Q2Q2Q2Q2Q2Q2Q2Q",
            authDomain: "tournament-platform-io.firebaseapp.com",
            projectId: "tournament-platform-io",
            storageBucket: "tournament-platform-io.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef1234567890abcdef"
        };

        // Initialize Firebase
        let firebaseApp, auth, db;
        let firebaseInitialized = false;
        
        // Application State
        const appState = {
            currentUser: null,
            userProfile: null,
            userType: 'player', // 'player' or 'admin'
            credits: 0,
            tournaments: [],
            liveStats: {
                activeUsers: 0,
                activeTournaments: 0,
                matchesToday: 0,
                totalPrizePool: 0
            }
        };

        // DOM Elements
        const navButtons = document.querySelectorAll('.nav-btn');
        const contentSections = document.querySelectorAll('.content-section');
        const firebaseStatus = document.getElementById('firebaseStatus');
        const loginBtn = document.getElementById('loginBtn');
        const registerBtn = document.getElementById('registerBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const profileIcon = document.getElementById('profile-icon');
        const creditBalance = document.getElementById('credit-balance');
        const tournamentsContainer = document.getElementById('tournamentsContainer');
        const createTournamentBtn = document.getElementById('createTournamentBtn');
        const saveProfileBtn = document.getElementById('saveProfileBtn');
        const profileAvatar = document.getElementById('profile-avatar');
        const profileName = document.getElementById('profile-name');
        const profileTitle = document.getElementById('profile-title');
        const profileBio = document.getElementById('profile-bio');
        const playerTitleSelect = document.getElementById('playerTitle');
        const playerBioTextarea = document.getElementById('playerBio');
        const statWins = document.getElementById('stat-wins');
        const statJoined = document.getElementById('stat-joined');
        const avatarOptions = document.querySelectorAll('.avatar-option');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const loginBox = document.getElementById('loginBox');
        const welcomeBox = document.getElementById('welcomeBox');
        const welcomeName = document.getElementById('welcomeName');
        const welcomeAvatar = document.getElementById('welcomeAvatar');
        const welcomeRole = document.getElementById('welcomeRole');
        const goToTournamentsBtn = document.getElementById('goToTournamentsBtn');
        const goToProfileBtn = document.getElementById('goToProfileBtn');
        const createTournamentModal = document.getElementById('createTournamentModal');
        const closeTournamentModal = document.getElementById('closeTournamentModal');
        const createTournamentSubmit = document.getElementById('createTournamentSubmit');
        const adminActions = document.getElementById('adminActions');
        const adminMessage = document.getElementById('adminMessage');
        const adminStats = document.getElementById('adminStats');
        const loadMoreTournaments = document.getElementById('loadMoreTournaments');

        // Initialize Firebase and Application
        async function init() {
            try {
                // Initialize Firebase
                firebaseApp = firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                db = firebase.firestore();
                
                // Enable offline persistence
                await db.enablePersistence();
                
                // Update Firebase status
                updateFirebaseStatus(true);
                console.log("Firebase initialized successfully");
                
                // Set up auth state listener
                auth.onAuthStateChanged(handleAuthStateChanged);
                
                // Load live stats
                loadLiveStats();
                
                // Set up event listeners
                setupEventListeners();
                
            } catch (error) {
                console.error("Firebase initialization error:", error);
                updateFirebaseStatus(false);
                // Use demo mode if Firebase fails
                initDemoMode();
            }
        }

        // Update Firebase connection status
        function updateFirebaseStatus(connected) {
            if (connected) {
                firebaseStatus.className = "firebase-status connected";
                firebaseStatus.innerHTML = '<span class="status-dot connected"></span><span>Firebase: Connected</span>';
                firebaseInitialized = true;
            } else {
                firebaseStatus.className = "firebase-status disconnected";
                firebaseStatus.innerHTML = '<span class="status-dot disconnected"></span><span>Firebase: Disconnected (Demo Mode)</span>';
                firebaseInitialized = false;
            }
        }

        // Handle auth state changes
        async function handleAuthStateChanged(user) {
            if (user) {
                // User is signed in
                appState.currentUser = user;
                console.log("User signed in:", user.email);
                
                // Load user profile
                await loadUserProfile(user.uid);
                
                // Update UI for logged in user
                updateUIForLoggedInUser();
                
                // Load tournaments
                loadTournaments();
                
            } else {
                // User is signed out
                appState.currentUser = null;
                appState.userProfile = null;
                console.log("User signed out");
                
                // Update UI for logged out user
                updateUIForLoggedOutUser();
                
                // Show login section
                switchSection('home');
                navButtons.forEach(btn => btn.classList.remove('active'));
                document.querySelector('[data-section="home"]').classList.add('active');
            }
        }

        // Load user profile from Firestore
        async function loadUserProfile(userId) {
            try {
                showLoading();
                const userDoc = await db.collection('users').doc(userId).get();
                
                if (userDoc.exists) {
                    appState.userProfile = userDoc.data();
                    appState.credits = appState.userProfile.credits || 100; // Default credits
                    appState.userType = appState.userProfile.isAdmin ? 'admin' : 'player';
                    
                    console.log("User profile loaded:", appState.userProfile);
                } else {
                    // Create new user profile
                    appState.userProfile = {
                        uid: userId,
                        email: appState.currentUser.email,
                        displayName: appState.currentUser.email.split('@')[0],
                        avatar: 'A',
                        title: 'Rookie',
                        bio: 'New tournament player',
                        credits: 100,
                        isAdmin: false,
                        tournamentsJoined: 0,
                        tournamentsWon: 0,
                        joinDate: new Date().toISOString()
                    };
                    
                    await db.collection('users').doc(userId).set(appState.userProfile);
                    console.log("New user profile created");
                }
                
                updateProfileUI();
                hideLoading();
                
            } catch (error) {
                console.error("Error loading user profile:", error);
                hideLoading();
            }
        }

        // Update UI for logged in user
        function updateUIForLoggedInUser() {
            // Show welcome box, hide login box
            loginBox.style.display = 'none';
            welcomeBox.style.display = 'block';
            
            // Update welcome box
            welcomeName.textContent = appState.userProfile?.displayName || 'User';
            welcomeAvatar.textContent = appState.userProfile?.avatar || 'A';
            welcomeRole.textContent = appState.userType === 'admin' ? 'Admin' : 'Player';
            welcomeAvatar.style.background = appState.userType === 'admin' 
                ? 'linear-gradient(45deg, #e74c3c, #f39c12)' 
                : 'linear-gradient(45deg, var(--primary-purple), var(--accent-purple))';
            
            // Update header
            profileIcon.textContent = appState.userProfile?.avatar || '?';
            creditBalance.textContent = appState.credits;
            
            // Show logout button
            logoutBtn.style.display = 'block';
            
            // Show create tournament button for admins
            if (appState.userType === 'admin') {
                createTournamentBtn.style.display = 'block';
                adminActions.style.display = 'grid';
                adminStats.style.display = 'block';
                adminMessage.textContent = 'Welcome, Administrator!';
                loadAdminStats();
            } else {
                createTournamentBtn.style.display = 'none';
                adminActions.style.display = 'none';
                adminStats.style.display = 'none';
                adminMessage.textContent = 'This area is accessible only to administrators.';
            }
            
            // Enable profile customization
            playerBioTextarea.disabled = false;
            saveProfileBtn.disabled = false;
        }

        // Update UI for logged out user
        function updateUIForLoggedOutUser() {
            // Show login box, hide welcome box
            loginBox.style.display = 'block';
            welcomeBox.style.display = 'none';
            
            // Update header
            profileIcon.textContent = '?';
            creditBalance.textContent = '0';
            
            // Hide logout button
            logoutBtn.style.display = 'none';
            
            // Hide create tournament button
            createTournamentBtn.style.display = 'none';
            
            // Disable profile customization
            playerBioTextarea.disabled = true;
            saveProfileBtn.disabled = true;
            
            // Reset profile UI
            profileName.textContent = 'Not Logged In';
            profileTitle.textContent = 'Player';
            profileBio.textContent = 'Login to customize your profile!';
            statWins.textContent = '0';
            statJoined.textContent = '0';
            profileAvatar.textContent = '?';
        }

        // Update profile UI
        function updateProfileUI() {
            if (!appState.userProfile) return;
            
            profileName.textContent = appState.userProfile.displayName;
            profileTitle.textContent = appState.userProfile.title;
            profileBio.textContent = appState.userProfile.bio;
            playerTitleSelect.value = appState.userProfile.title;
            playerBioTextarea.value = appState.userProfile.bio;
            statWins.textContent = appState.userProfile.tournamentsWon || 0;
            statJoined.textContent = appState.userProfile.tournamentsJoined || 0;
            profileAvatar.textContent = appState.userProfile.avatar;
            profileIcon.textContent = appState.userProfile.avatar;
            creditBalance.textContent = appState.userProfile.credits || 0;
            
            // Format join date
            if (appState.userProfile.joinDate) {
                const joinDate = new Date(appState.userProfile.joinDate);
                document.getElementById('profile-join-date').textContent = `Member since: ${joinDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}`;
            }
            
            // Update avatar selection
            avatarOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.getAttribute('data-avatar') === appState.userProfile.avatar) {
                    option.classList.add('selected');
                }
            });
        }

        // Load tournaments from Firestore
        async function loadTournaments() {
            try {
                showLoading();
                tournamentsContainer.innerHTML = '';
                
                const tournamentsSnapshot = await db.collection('tournaments')
                    .where('status', '==', 'open')
                    .orderBy('createdAt', 'desc')
                    .limit(10)
                    .get();
                
                appState.tournaments = [];
                tournamentsSnapshot.forEach(doc => {
                    appState.tournaments.push({ id: doc.id, ...doc.data() });
                });
                
                renderTournaments();
                hideLoading();
                
                // Show load more button if we have tournaments
                loadMoreTournaments.style.display = appState.tournaments.length > 0 ? 'block' : 'none';
                
            } catch (error) {
                console.error("Error loading tournaments:", error);
                hideLoading();
            }
        }

        // Render tournaments to the UI
        function renderTournaments() {
            tournamentsContainer.innerHTML = '';
            
            if (appState.tournaments.length === 0) {
                tournamentsContainer.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #aaa;">
                        <i class="fas fa-trophy" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3>No Tournaments Available</h3>
                        <p>Be the first to create a tournament!</p>
                    </div>
                `;
                return;
            }
            
            appState.tournaments.forEach(tournament => {
                const tournamentCard = document.createElement('div');
                tournamentCard.className = 'tournament-card';
                
                // Check if user has already joined
                const hasJoined = appState.userProfile && 
                    appState.userProfile.joinedTournaments &&
                    appState.userProfile.joinedTournaments.includes(tournament.id);
                
                // Format date
                const tournamentDate = tournament.date ? new Date(tournament.date).toLocaleDateString() : 'TBD';
                
                tournamentCard.innerHTML = `
                    <h3 class="tournament-title">${tournament.title}</h3>
                    <div class="tournament-game">${tournament.game}</div>
                    <div class="tournament-details">
                        <div><i class="far fa-calendar"></i> ${tournamentDate}</div>
                        <div><i class="fas fa-users"></i> ${tournament.participants || 0}/${tournament.maxParticipants || 64}</div>
                    </div>
                    <div class="tournament-details">
                        <div class="tournament-prize"><i class="fas fa-award"></i> $${tournament.prize || 0} Prize</div>
                        <div class="tournament-cost"><i class="fas fa-coins"></i> ${tournament.cost || 0} Credits</div>
                    </div>
                    <div class="tournament-actions">
                        <button class="btn btn-small btn-outline view-details-btn" data-id="${tournament.id}">Details</button>
                        ${hasJoined ? 
                            '<button class="btn btn-small" disabled style="background-color: var(--success);">Joined</button>' : 
                            `<button class="btn btn-small join-btn" data-id="${tournament.id}" ${appState.credits < tournament.cost ? 'disabled' : ''}>Join Tournament</button>`
                        }
                    </div>
                `;
                
                tournamentsContainer.appendChild(tournamentCard);
            });
            
            // Add event listeners to join buttons
            document.querySelectorAll('.join-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const tournamentId = this.getAttribute('data-id');
                    joinTournament(tournamentId);
                });
            });
        }

        // Join a tournament
        async function joinTournament(tournamentId) {
            try {
                const tournament = appState.tournaments.find(t => t.id === tournamentId);
                if (!tournament) return;
                
                // Check if user has enough credits
                if (appState.credits < tournament.cost) {
                    alert(`You don't have enough credits. You need ${tournament.cost} credits but only have ${appState.credits}.`);
                    return;
                }
                
                if (confirm(`Join "${tournament.title}" for ${tournament.cost} credits?`)) {
                    showLoading();
                    
                    // Update user credits
                    const newCredits = appState.credits - tournament.cost;
                    await db.collection('users').doc(appState.currentUser.uid).update({
                        credits: newCredits,
                        tournamentsJoined: firebase.firestore.FieldValue.increment(1),
                        joinedTournaments: firebase.firestore.FieldValue.arrayUnion(tournamentId)
                    });
                    
                    // Update tournament participants
                    await db.collection('tournaments').doc(tournamentId).update({
                        participants: firebase.firestore.FieldValue.increment(1)
                    });
                    
                    // Update local state
                    appState.credits = newCredits;
                    appState.userProfile.credits = newCredits;
                    appState.userProfile.tournamentsJoined = (appState.userProfile.tournamentsJoined || 0) + 1;
                    
                    // Update UI
                    creditBalance.textContent = appState.credits;
                    statJoined.textContent = appState.userProfile.tournamentsJoined;
                    
                    alert(`Successfully joined "${tournament.title}"! ${tournament.cost} credits deducted.`);
                    
                    // Reload tournaments
                    loadTournaments();
                    hideLoading();
                }
                
            } catch (error) {
                console.error("Error joining tournament:", error);
                alert("Failed to join tournament. Please try again.");
                hideLoading();
            }
        }

        // Create a new tournament (admin only)
        async function createTournament(tournamentData) {
            try {
                showLoading();
                
                const newTournament = {
                    title: tournamentData.title,
                    game: tournamentData.game,
                    date: tournamentData.date,
                    prize: parseInt(tournamentData.prize),
                    cost: parseInt(tournamentData.cost),
                    maxParticipants: parseInt(tournamentData.maxParticipants),
                    participants: 0,
                    status: 'open',
                    createdBy: appState.currentUser.uid,
                    createdAt: new Date().toISOString()
                };
                
                await db.collection('tournaments').add(newTournament);
                
                alert('Tournament created successfully!');
                createTournamentModal.classList.remove('active');
                
                // Reload tournaments
                loadTournaments();
                hideLoading();
                
            } catch (error) {
                console.error("Error creating tournament:", error);
                alert("Failed to create tournament. Please try again.");
                hideLoading();
            }
        }

        // Save profile changes
        async function saveProfile() {
            try {
                showLoading();
                
                const updates = {
                    avatar: document.querySelector('.avatar-option.selected').getAttribute('data-avatar'),
                    title: playerTitleSelect.value,
                    bio: playerBioTextarea.value
                };
                
                await db.collection('users').doc(appState.currentUser.uid).update(updates);
                
                // Update local state
                appState.userProfile.avatar = updates.avatar;
                appState.userProfile.title = updates.title;
                appState.userProfile.bio = updates.bio;
                
                updateProfileUI();
                alert('Profile saved successfully!');
                hideLoading();
                
            } catch (error) {
                console.error("Error saving profile:", error);
                alert("Failed to save profile. Please try again.");
                hideLoading();
            }
        }

        // Load live stats
        async function loadLiveStats() {
            try {
                // In a real app, you would have actual statistics
                // For demo, we'll use simulated data
                appState.liveStats.activeUsers = Math.floor(Math.random() * 100) + 50;
                appState.liveStats.activeTournaments = Math.floor(Math.random() * 20) + 5;
                appState.liveStats.matchesToday = Math.floor(Math.random() * 100) + 20;
                appState.liveStats.totalPrizePool = Math.floor(Math.random() * 50000) + 10000;
                
                // Update UI
                document.getElementById('liveUsersCount').textContent = appState.liveStats.activeUsers;
                document.getElementById('liveTournamentsCount').textContent = appState.liveStats.activeTournaments;
                document.getElementById('liveMatchesCount').textContent = appState.liveStats.matchesToday;
                document.getElementById('livePrizePool').textContent = `$${appState.liveStats.totalPrizePool.toLocaleString()}`;
                
            } catch (error) {
                console.error("Error loading live stats:", error);
            }
        }

        // Load admin stats
        async function loadAdminStats() {
            try {
                // Simulated admin stats for demo
                document.getElementById('totalUsers').textContent = Math.floor(Math.random() * 1000) + 500;
                document.getElementById('totalTournaments').textContent = Math.floor(Math.random() * 200) + 50;
                document.getElementById('totalCredits').textContent = Math.floor(Math.random() * 100000) + 50000;
                document.getElementById('totalPrize').textContent = `$${Math.floor(Math.random() * 500000) + 100000}`;
                
            } catch (error) {
                console.error("Error loading admin stats:", error);
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Navigation
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const sectionId = button.getAttribute('data-section');
                    switchSection(sectionId);
                    
                    // Update active button
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                });
            });

            // Auth buttons
            loginBtn.addEventListener('click', handleLogin);
            registerBtn.addEventListener('click', handleRegister);
            logoutBtn.addEventListener('click', handleLogout);
            
            // Profile icon click
            profileIcon.addEventListener('click', () => {
                if (appState.currentUser) {
                    switchSection('profile');
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    document.querySelector('[data-section="profile"]').classList.add('active');
                } else {
                    switchSection('home');
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    document.querySelector('[data-section="home"]').classList.add('active');
                }
            });

            // Welcome box buttons
            goToTournamentsBtn.addEventListener('click', () => {
                switchSection('tournaments');
                navButtons.forEach(btn => btn.classList.remove('active'));
                document.querySelector('[data-section="tournaments"]').classList.add('active');
            });
            
            goToProfileBtn.addEventListener('click', () => {
                switchSection('profile');
                navButtons.forEach(btn => btn.classList.remove('active'));
                document.querySelector('[data-section="profile"]').classList.add('active');
            });

            // Tournament buttons
            createTournamentBtn.addEventListener('click', () => {
                createTournamentModal.classList.add('active');
            });
            
            closeTournamentModal.addEventListener('click', () => {
                createTournamentModal.classList.remove('active');
            });
            
            createTournamentSubmit.addEventListener('click', () => {
                const tournamentData = {
                    title: document.getElementById('tournamentName').value,
                    game: document.getElementById('tournamentGame').value,
                    date: document.getElementById('tournamentDate').value,
                    prize: document.getElementById('tournamentPrize').value,
                    cost: document.getElementById('tournamentCost').value,
                    maxParticipants: document.getElementById('tournamentMax').value
                };
                
                // Validate
                if (!tournamentData.title || !tournamentData.game || !tournamentData.date || 
                    !tournamentData.prize || !tournamentData.cost || !tournamentData.maxParticipants) {
                    alert('Please fill in all fields');
                    return;
                }
                
                createTournament(tournamentData);
            });

            // Profile buttons
            saveProfileBtn.addEventListener('click', saveProfile);

            // Avatar selection
            avatarOptions.forEach(option => {
                option.addEventListener('click', () => {
                    if (!appState.currentUser) return;
                    avatarOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                });
            });

            // Load more tournaments
            loadMoreTournaments.addEventListener('click', () => {
                // In a real app, this would load more tournaments
                alert('This would load more tournaments in a full implementation.');
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === createTournamentModal) {
                    createTournamentModal.classList.remove('active');
                }
            });
        }

        // Handle login
        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const adminCode = document.getElementById('adminCode').value;
            
            if (!email || !password) {
                alert('Please enter email and password');
                return;
            }
            
            try {
                showLoading();
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                console.log("Login successful");
                
                // Check for admin code
                if (adminCode === 'admin123') {
                    // Make user an admin
                    await db.collection('users').doc(userCredential.user.uid).update({
                        isAdmin: true
                    });
                }
                
                hideLoading();
                
            } catch (error) {
                console.error("Login error:", error);
                hideLoading();
                
                if (error.code === 'auth/user-not-found') {
                    // User doesn't exist, offer to register
                    if (confirm('User not found. Would you like to register instead?')) {
                        handleRegister();
                    }
                } else if (error.code === 'auth/wrong-password') {
                    alert('Incorrect password. Please try again.');
                } else {
                    alert('Login failed. Please try again.');
                }
            }
        }

        // Handle registration
        async function handleRegister() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const adminCode = document.getElementById('adminCode').value;
            
            if (!email || !password) {
                alert('Please enter email and password');
                return;
            }
            
            if (password.length < 6) {
                alert('Password must be at least 6 characters');
                return;
            }
            
            try {
                showLoading();
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                console.log("Registration successful");
                
                // Create user profile with admin status if code is correct
                const isAdmin = adminCode === 'admin123';
                
                await db.collection('users').doc(userCredential.user.uid).set({
                    uid: userCredential.user.uid,
                    email: email,
                    displayName: email.split('@')[0],
                    avatar: 'A',
                    title: 'Rookie',
                    bio: 'New tournament player',
                    credits: isAdmin ? 1000 : 100, // Admins get more credits
                    isAdmin: isAdmin,
                    tournamentsJoined: 0,
                    tournamentsWon: 0,
                    joinDate: new Date().toISOString()
                });
                
                hideLoading();
                
            } catch (error) {
                console.error("Registration error:", error);
                hideLoading();
                
                if (error.code === 'auth/email-already-in-use') {
                    alert('Email already in use. Please login instead.');
                } else if (error.code === 'auth/weak-password') {
                    alert('Password is too weak. Please use a stronger password.');
                } else {
                    alert('Registration failed. Please try again.');
                }
            }
        }

        // Handle logout
        async function handleLogout() {
            try {
                await auth.signOut();
                console.log("Logout successful");
            } catch (error) {
                console.error("Logout error:", error);
            }
        }

        // Switch between content sections
        function switchSection(sectionId) {
            contentSections.forEach(section => {
                section.classList.remove('active');
                if (section.id === sectionId) {
                    section.classList.add('active');
                }
            });
        }

        // Show loading spinner
        function showLoading() {
            loadingSpinner.classList.add('active');
        }

        // Hide loading spinner
        function hideLoading() {
            loadingSpinner.classList.remove('active');
        }

        // Initialize demo mode if Firebase fails
        function initDemoMode() {
            console.log("Initializing demo mode");
            
            // Set up event listeners for demo mode
            setupEventListeners();
            
            // Mock auth state for demo
            setTimeout(() => {
                appState.currentUser = { email: 'demo@user.com', uid: 'demo123' };
                appState.userProfile = {
                    displayName: 'Demo User',
                    avatar: 'A',
                    title: 'Demo Player',
                    bio: 'This is a demo account. Register to save your data!',
                    credits: 500,
                    isAdmin: false,
                    tournamentsJoined: 5,
                    tournamentsWon: 1,
                    joinDate: new Date().toISOString()
                };
                appState.credits = 500;
                
                updateUIForLoggedInUser();
                loadLiveStats();
                
                // Show demo tournaments
                appState.tournaments = [
                    {
                        id: 'demo1',
                        title: 'COD Championship',
                        game: 'Call of Duty: Warzone',
                        date: '2023-10-15',
                        prize: '5,000',
                        cost: 200,
                        participants: 32,
                        maxParticipants: 64,
                        status: 'open'
                    },
                    {
                        id: 'demo2',
                        title: 'Weekend Showdown',
                        game: 'Call of Duty: Modern Warfare',
                        date: '2023-10-08',
                        prize: '2,500',
                        cost: 100,
                        participants: 48,
                        maxParticipants: 64,
                        status: 'open'
                    }
                ];
                
                renderTournaments();
                
            }, 1000);
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', init);
        
        // Auto-refresh live stats every 30 seconds
        setInterval(loadLiveStats, 30000);
    </script>
</body>
</html>